<!doctype html>
<html lang="en">

<head>
    <!-- Required meta tags -->
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

    <!-- Bootstrap CSS -->
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap@4.3.1/dist/css/bootstrap.min.css"
        integrity="sha384-ggOyR0iXCbMQv3Xipma34MD+dH/1fQ784/j6cY/iJTQUOhcWr7x9JvoRxT2MZw1T" crossorigin="anonymous">

    <title>Hello, world!</title>

    <style>
        @page {
            size: letter portrait;
            margin: 70pt 60pt 70pt;
        }

        .row {
            display: -webkit-box;
        }

        /* Container holding the image and the text */
        div {
            page-break-inside: avoid;
        }

        .container {
            position: relative;
            font-family: "Franklin Gothic Book";
            width: 100%;
        }

        /* Centered text */
        .centered {
            position: absolute;
            top: 45%;
            left: 20%;
            width: 50%;
            /* transform: translate(-50%, -50%); */
            color: white;
        }

        h1 {
            font-size: 30px;
        }

        h2 {
            font-size: 25px;
            font-family: "Franklin Gothic Book";
        }

        @font-face {
            font-family: "Franklin Gothic Book";
            src: url("/var/www/pe-reports/src/pe_reports/helpers/bulletin/Franklin_Gothic_Book_Regular.ttf");
        }
    </style>

</head>

<body>

    <div style="padding:2em">
        <h1>Credential Breach Bulletin</h1>
        <p>The Posture and Exposure Bulletin Service was designed to serve as a way to communicate imminent risks
            outside of the normal semimonthly reporting period. These risks include but are not limited to, PII
            exposures, data leaks, documented system access, etc. This report similar to the standard P&E report will
            not attempt to verify any of the information stored, and in the case of PII will not store the information
            within any DHS hosted systems. If you have any questions about the findings, please email us at
            vulnerability@cisa.dhs.gov.</p>
        <h2 style="color:#005288">HIGHLIGHTS</h2>
        <p>
            <b>Breach Name:</b> &nbsp;{{breach_name}}
        </p>
        <p> <b>Description: </b> &nbsp;{{description.split("Query to find the related intel item:")[0]}}</p>
        <p> <b>Original Breach Date: </b> &nbsp;{{breach_date.strftime("%b %d, %Y ")}}</p>
        <p> <b>Number of Your Credentials Exposed: </b> &nbsp;{{email_count}}</p>
        {% if data_source == 'HaveIBeenPwnd' %}
        <p><b>Number of Credentials in Breach: </b>&nbsp; {{exposed_cred_count}}</p>
        {% endif %}

        {% if data_classes %}
        <p><b>Data Types Identified in Breach:</b>
        <ul>
            {% for data_type in data_classes %}
            <li>{{data_type}}</li>
            {% endfor %}
        </ul>
        {% endif %}
        </p>
        <h2 style="color:#005288">DETAILED INFORMATION (Warning Sensitive Content)</h2>

        {% if data_source == 'HaveIBeenPwnd' %}
        {% for row in hibp_rows %}
        <div class="row">
            {% for email in row %}
            <div class="col-6" style="text-align: center;">
                <p>
                    {{email}}
                </p>
            </div>
            {% endfor %}
        </div>
        {% endfor %}
        {% elif data_source == 'Cybersixgill' %}
        {{df_table|safe}}
        {% endif %}


    </div>

    <!-- Optional JavaScript -->
    <!-- jQuery first, then Popper.js, then Bootstrap JS -->
    <script src="https://code.jquery.com/jquery-3.3.1.slim.min.js"
        integrity="sha384-q8i/X+965DzO0rT7abK41JStQIAqVgRVzpbzo5smXKp4YfRvH+8abtTE1Pi6jizo"
        crossorigin="anonymous"></script>
    <script src="https://cdn.jsdelivr.net/npm/popper.js@1.14.7/dist/umd/popper.min.js"
        integrity="sha384-UO2eT0CpHqdSJQ6hJty5KVphtPhzWj9WO1clHTMGa3JDZwrnQq4sF86dIHNDz0W1"
        crossorigin="anonymous"></script>
    <script src="https://cdn.jsdelivr.net/npm/bootstrap@4.3.1/dist/js/bootstrap.min.js"
        integrity="sha384-JjSmVgyd0p3pXB1rRibZUAYoIIy6OrQ6VrjIEaFf/nJGzIxFDsf4x0xIM+B07jRM"
        crossorigin="anonymous"></script>
</body>

</html>